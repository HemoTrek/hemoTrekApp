<TestScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        md_bg_color: app.theme_cls.primaryColor

        MDTopAppBar:
            type: "small"
            size_hint_x: 1.01
            pos_hint: {"center_x": .5, "center_y": .5}  

            MDTopAppBarTitle:
                id: patientName_label
                halign: "center"


        # --------------------------- Main Content Below ---------------------------
        MDBoxLayout:
            orientation: "vertical"
            spacing: "20dp"
            padding: "20dp"
            size_hint_y: 0.7  # Adjusting size

            # Wholeblood and Serum boxes side by side
            MDBoxLayout:
                orientation: "horizontal"
                spacing: "20dp"
                size_hint_y: 0.6  # Adjust height

                #WHOLEBLOOD
                MDBoxLayout:
                    orientation: "vertical"
                    size_hint_x: 0.45
                    size_hint_y: 1
                    md_bg_color: 0.9, 0.9, 0.9, 1  # Light grey background
                    padding: "20dp"
                    radius: [20, 20, 20, 20]

                    MDLabel:
                        text: "Wholeblood Viscosity"
                        color: "black"
                        font: "Display"
                        halign: "center"

                    MDCircularProgressIndicator:
                        id: wholeblood_progress
                        size_hint: None, None
                        size: "48dp", "48dp"
                        color: "black"
                        pos_hint: {"center_x": .5, "center_y": .5}  
                        opacity: 1 

                    # Label for "Hyperviscosity Number"
                    MDLabel:
                        id: wholeblood_viscosity
                        halign: "center"
                        font_style: "Display"
                        color: "black"                   


                #SERUM
                MDBoxLayout:
                    orientation: "vertical"
                    size_hint_x: 0.45
                    size_hint_y: 1
                    md_bg_color: 0.9, 0.9, 0.9, 1  
                    padding: "20dp"
                    radius: [20, 20, 20, 20]

                    MDLabel:
                        text: "Serum Viscosity"
                        font: "Display"
                        color: "black"
                        halign: "center"

                    MDCircularProgressIndicator:
                        id: serum_progress
                        size_hint: None, None
                        size: "48dp", "48dp"
                        color: "black"
                        pos_hint: {"center_x": .5, "center_y": .5}  
                        opacity: 1 

                    # Label for "Serum Viscosity"
                    MDLabel:
                        id: serum_viscosity
                        halign: "center"
                        font_style: "Display"
                        color: "black"         

            # One wide box underneath
            MDBoxLayout:
                size_hint_y: 0.3  # Shorter than the top row
                md_bg_color: 0.9, 0.9, 0.9, 1  
                padding: "20dp"
                radius: [20, 20, 20, 20]
                
                MDLabel:
                    text: "Hyperviscosity Syndrome Evaluation:"
                    font: "Display"
                    color: "black"
                    halign: "left"
                
                MDCircularProgressIndicator:
                    id: HVS_progress
                    size_hint: None, None
                    size: "48dp", "48dp"
                    color: "black"
                    pos_hint: {"center_x": .5, "center_y": .5}  
                
                # Label for "Hyperviscosity Number"
                MDLabel:
                    id: HVS_evaluation
                    halign: "center"
                    font_style: "Display"
                    color: "black"         

        MDBoxLayout:
            orientation: "vertical"
            spacing: "20dp"
            padding: "20dp"
            size_hint_y: 0.3

            GridLayout:
                cols: 2
                padding: 20
                spacing: 20
                
                MDButton:
                    size_hint: None, None
                    size: ("150dp", "50dp")
                    pos_hint: {"center_x": .5, "center_y": .5}              
                    on_press: root.update_wholeblood_result()

                    MDButtonText:
                        text: "Update Wholeblood"

                MDButton:
                    size_hint: None, None
                    size: ("150dp", "50dp")
                    pos_hint: {"center_x": .5, "center_y": .5}              
                    on_press: root.update_serum_result()

                    MDButtonText:
                        text: "Update Serum"

                MDButton:
                    size_hint: None, None
                    size: ("150dp", "50dp")
                    pos_hint: {"center_x": .5, "center_y": .5}              
                    on_press: root.update_HVS_result()

                    MDButtonText:
                        text: "Update HVS"

                MDButton:
                    size_hint: None, None
                    size: ("150dp", "50dp")
                    pos_hint: {"center_x": .5, "center_y": .5}              
                    on_press: root.open_cleaning_screen()

                    MDButtonText:
                        text: "Proceed to Cleaning"
