<TestScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        md_bg_color: app.theme_cls.primary_color        

        MDTopAppBar:
            type: "small"
            size_hint_x: 1.01
            pos_hint: {"center_x": .5, "center_y": .5}  

            MDTopAppBarTitle:
                id: patientName_label
                halign: "center"


        # --------------------------- Main Content Below ---------------------------
        MDBoxLayout:
            orientation: "vertical"
            spacing: "20dp"
            padding: "20dp"
            size_hint_y: 0.7  # Adjusting size

            # Wholeblood and Serum boxes side by side
            MDBoxLayout:
                orientation: "horizontal"
                spacing: "20dp"
                size_hint_y: 0.6  # Adjust height

                #WHOLEBLOOD
                MDBoxLayout:
                    orientation: "vertical"
                    size_hint_x: 0.45
                    size_hint_y: 1
                    md_bg_color: 0.9, 0.9, 0.9, 1  # Light grey background
                    padding: "20dp"
                    radius: [20, 20, 20, 20]

                    MDLabel:
                        text: "[size=36]Wholeblood Viscosity[/size]"
                        color: "black"
                        font: "Display"
                        halign: "center"
                        markup: True

                    MDCircularProgressIndicator:
                        id: wholeblood_progress
                        size_hint: None, None
                        size: "48dp", "48dp"
                        color: "black"
                        pos_hint: {"center_x": .5, "center_y": .5}  
                        opacity: 1 

                    # Label for "Hyperviscosity Number"
                    MDLabel:
                        id: wholeblood_viscosity
                        halign: "center"
                        font_style: "Display"
                        color: "black"                   


                #SERUM
                MDBoxLayout:
                    orientation: "vertical"
                    size_hint_x: 0.45
                    size_hint_y: 1
                    md_bg_color: 0.9, 0.9, 0.9, 1  
                    padding: "20dp"
                    radius: [20, 20, 20, 20]

                    MDLabel:
                        text: "[size=36]Serum Viscosity[/size]"
                        font: "Display"
                        color: "black"
                        halign: "center"
                        markup: True

                    MDCircularProgressIndicator:
                        id: serum_progress
                        size_hint: None, None
                        size: "48dp", "48dp"
                        color: "black"
                        pos_hint: {"center_x": .5, "center_y": .5}  
                        opacity: 1 

                    # Label for "Serum Viscosity"
                    MDLabel:
                        id: serum_viscosity
                        halign: "center"
                        font_style: "Display"
                        color: "black"         

            # One wide box underneath
            MDBoxLayout:
                size_hint_y: 0.3  # Shorter than the top row
                md_bg_color: 0.9, 0.9, 0.9, 1  
                padding: "20dp"
                radius: [20, 20, 20, 20]
                
                MDLabel:
                    text: "[size=20]Hyperviscosity Syndrome Evaluation:[/size]"
                    font: "Display"
                    color: "black"
                    halign: "left"
                    markup: True
                
                MDCircularProgressIndicator:
                    id: HVS_progress
                    size_hint: None, None
                    size: "48dp", "48dp"
                    color: "black"
                    pos_hint: {"center_x": .5, "center_y": .5}  
                
                # Label for "Hyperviscosity Number"
                MDLabel:
                    id: HVS_evaluation
                    halign: "center"
                    font_style: "Display"
                    color: "black"         

        MDBoxLayout:
            orientation: "horizontal"
            size_hint_y: 0.2
            padding: "20dp"
            spacing: "10dp"

            AnchorLayout:
                anchor_x: "center"
                anchor_y: "bottom"
                
                MDBoxLayout:
                    orientation: "horizontal"
                    size_hint_y: 0.2  # Controls vertical space taken
                    spacing: "10dp"  # Prevents buttons from touching

                    MDButton:
                        id: results_recorded_button
                        style: "elevated"
                        theme_width: "Custom"
                        height: "80"
                        size_hint_x: 0.3  
                        on_press: root.enable_cleaning_button()

                        MDButtonText:
                            text: "Results Recorded"
                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            font_style: "Title"

                    MDButton:
                        id: proceed_to_cleaning_button
                        style: "elevated"
                        theme_width: "Custom"
                        height: "80"
                        size_hint_x: 0.7  
                        disabled: True  # Initially disabled until Results Recorded button is pressed
                        on_press: root.open_cleaning_screen()

                        MDButtonText:
                            text: "Proceed to Cleaning"
                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            font_style: "Title"
